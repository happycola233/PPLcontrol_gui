# PPLcontrol GUI

PPLcontrol GUI 是一个基于 Python 的图形用户界面程序，用于简化对 Windows 进程保护级别的操作。该程序修改自 [itm4n/PPLcontrol](https://github.com/itm4n/PPLcontrol)，提供了更友好的用户界面，使用户能够方便地管理 Windows 系统中的受保护进程。

## 功能简介

- **列出受保护进程**：显示当前系统中所有受保护的进程。
- **获取进程保护级别**：输入进程 PID 并获取其保护级别。
- **设置进程保护级别**：为指定进程设置保护级别。
- **保护进程**：为指定进程应用保护。
- **取消保护进程**：移除指定进程的保护。
- **安装驱动程序**：安装 `RTCore64.sys` 驱动程序。
- **卸载驱动程序**：卸载 `RTCore64.sys` 驱动程序。
- **运行 `tasklist` 命令**：列出当前系统中的所有进程。

## 使用说明

### 环境准备

在使用本程序前，请确保您具备以下条件：

1. **系统要求**：该程序仅适用于 **Windows 10/11 64位系统**。
2. **管理员权限**：需要以管理员权限运行该程序，因为部分操作涉及系统级别的配置，如驱动程序的安装和卸载。

### 使用步骤

1. 下载并运行 `PPLcontrol_gui.exe`。

2. 打开程序后，您将看到一个图形用户界面，包含以下功能按钮：

    - **安装驱动**: 在开始操作前，请务必点击“安装驱动”按钮，安装所需的 `RTCore64.sys` 驱动程序。
    - **卸载驱动**: 程序运行结束后，请点击“卸载驱动”按钮，以移除安装的驱动程序。

3. 在界面中，您可以选择以下操作：

    - **tasklist命令**: 点击按钮，列出当前系统中正在运行的所有进程。
    - **列出受保护进程**: 显示当前系统中所有受保护的进程。
    - **获取进程保护级别**: 输入进程 PID 并获取其保护级别。
    - **设置进程保护级别**: 输入进程 PID 并为其设置保护级别。
    - **保护进程**: 输入进程 PID 并为其应用保护。
    - **取消保护进程**: 输入进程 PID 并移除其保护。

4. **右键菜单**：在输出框内点击鼠标右键可以访问上下文菜单，包含以下选项：
    - **清屏**: 清除输出框中的所有内容。
    - **复制选中内容**: 复制当前选中的文本内容到剪贴板。
    - **复制全部内容**: 复制输出框中的所有内容到剪贴板。

### 保护类型和签名者类型的详细说明

#### 保护类型（Protection Type）

PPL（Protected Process Light，受保护的轻量级进程）是微软在 Windows 8.1 中引入的一种进程保护机制。它是一种特殊类型的进程保护，与早期的受保护进程（Protected Process）机制类似，但其应用范围更广泛，主要用于提高系统和应用程序的安全性。

- **`None`**: 无保护。这是最基础的级别，进程不受保护。
- **`PPL`**: 受保护的轻量级进程。提供一定级别的保护，防止低级别进程对其进行操作，更常用。
- **`PP`**: 受保护的进程。与 PPL 类似，但具有更高的安全级别，通常用于保护核心系统进程。

#### 签名者类型（Signer Type）

在 Windows 的 PPL 机制中，Signer Type（签名者类型）是用于标识进程或代码签名的类型。不同的签名者类型代表了不同的信任级别，信任级别越高的签名者可以对级别较低的 PPL 进程执行某些操作。

以下是 Signer Types 的详细说明：

1. **Authenticode**
   - **描述**: Authenticode 是一种基于公钥加密的代码签名技术，微软用于确保软件发布者的身份和软件的完整性。Authenticode 签名的代码通常用于一般应用程序和驱动程序。
   - **应用场景**: 主要用于那些需要经过微软签名验证的第三方应用程序和驱动程序。

2. **CodeGen**
   - **描述**: CodeGen（代码生成）通常与动态生成代码相关联。这种签名类型可能用于那些通过编程生成的代码模块，特别是在编译时无法预知这些模块的情况下。
   - **应用场景**: 用于运行时生成或修改代码的应用程序或进程。

3. **Antimalware**
   - **描述**: Antimalware 签名类型专门用于反恶意软件产品，如 Windows Defender 和其他防病毒软件。这些进程受保护以防止恶意软件尝试禁用或篡改它们。
   - **应用场景**: 用于反恶意软件软件，以确保它们在系统中执行其安全功能时不会被恶意软件攻击。

4. **Lsa (Local Security Authority)**
   - **描述**: LSA 签名类型用于保护与本地安全机构（Local Security Authority, LSA）相关的进程，这些进程负责执行 Windows 中的安全策略。
   - **应用场景**: 例如 LSASS.exe，它是 Windows 中的关键安全进程，处理用户登录、密码验证等安全功能。

5. **Windows**
   - **描述**: Windows 签名类型适用于大部分由微软直接提供的系统组件和服务。这些进程或代码模块受到更高级别的保护。
   - **应用场景**: 通常用于保护 Windows 操作系统的核心组件，如服务和系统进程。

6. **WinTcb (Windows Trusted Computing Base)**
   - **描述**: WinTcb 是最高信任级别的签名类型之一，适用于操作系统的核心部分。这些进程对于系统的稳定性和安全性至关重要，因此需要最高级别的保护。
   - **应用场景**: 用于 Windows 内核和其他关键系统组件，确保它们免受任何形式的干扰或攻击。

7. **WinSystem**
   - **描述**: WinSystem 签名类型也用于操作系统的重要组件，但其信任级别略低于 WinTcb。它保护的对象仍然是关键的系统进程，但这些进程可能不属于系统的核心。
   - **应用场景**: 主要用于系统级别的服务和后台进程，这些进程不如内核级别的进程重要，但仍然需要保护。

### 注意事项

- **安装驱动**：请务必在开始任何操作前先点击“**安装驱动**”按钮，以确保程序能够正常工作。
- **卸载驱动**：在程序操作结束后，请及时点击“**卸载驱动**”按钮，以移除驱动，避免对系统造成不必要的影响。

### 高 DPI 支持

该程序包含对高 DPI 显示的支持，以确保在高分辨率显示器上显示清晰、正常。如果您的显示器有缩放设置，程序会自动适配缩放比例。

## 项目说明

该项目基于 [itm4n/PPLcontrol](https://github.com/itm4n/PPLcontrol) 修改和扩展，主要增加了图形用户界面，并优化了用户操作流程。
